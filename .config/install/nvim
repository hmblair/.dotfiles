#!/usr/bin/env zsh

if ! command -v nvim &> /dev/null; then
    pushd /tmp > /dev/null
    git clone https://github.com/neovim/neovim
    cd neovim

    export CFLAGS="-march=native"
    export CXXFLAGS="-march=native"

    make CMAKE_BUILD_TYPE=RelWithDebInfo

    if sudo -l &>/dev/null; then
        sudo make install CMAKE_INSTALL_PREFIX="/usr/local"
    else
        make install CMAKE_INSTALL_PREFIX="$HOME/.local"
    fi

    popd > /dev/null
fi
